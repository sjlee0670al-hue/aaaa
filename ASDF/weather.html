<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì§€ë„ ê¸°ë°˜ ë‚ ì”¨ ì•±</title>

<!-- êµ¬ê¸€ í°íŠ¸ -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>
    body {
        font-family: 'Poppins', sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        transition: background 1s;
        background: linear-gradient(135deg, #89CFF0, #5D8BF4);
        color: #fff;
    }

    h1 {
        font-weight: 600;
        margin-top: 20px;
        text-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
    }

    #map {
        width: 90%;
        max-width: 800px;
        height: 400px;
        margin-top: 20px;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
    }

    #weather-container {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(15px);
        margin-top: 20px;
        padding: 25px;
        border-radius: 15px;
        width: 330px;
        text-align: center;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        animation: fadeIn 1s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }

    h2 {
        font-size: 1.5em;
        font-weight: 600;
        margin-bottom: 10px;
    }

    .weather-info p {
        margin: 8px 0;
        font-size: 1.1em;
    }

    #weather-icon {
        width: 80px;
        margin: 10px 0;
    }

    .error {
        color: #ff4d4d;
        font-weight: bold;
        margin-top: 10px;
    }
</style>
</head>
<body>

<h1>ğŸŒ¤ ì§€ë„ ê¸°ë°˜ ë‚ ì”¨ ì¡°íšŒ</h1>

<div id="map"></div>

<div id="weather-container">
    <h2 id="city-name">ë„ì‹œ ì´ë¦„</h2>
    <img id="weather-icon" src="" alt="weather icon">
    <div class="weather-info">
        <p>ë‚ ì”¨: <span id="weather-desc">--</span></p>
        <p>ì˜¨ë„: <span id="temperature">--</span>Â°C</p>
        <p>ìŠµë„: <span id="humidity">--</span>%</p>
        <p>ë°”ëŒ: <span id="wind-speed">--</span> m/s</p>
    </div>
    <p class="error" id="error-message"></p>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const API_KEY = "db35be491245abfc0367098faedbb189";
const BASE_URL = "https://api.openweathermap.org/data/2.5/weather";

const cityNameEl = document.getElementById('city-name');
const weatherDescEl = document.getElementById('weather-desc');
const tempEl = document.getElementById('temperature');
const humidityEl = document.getElementById('humidity');
const windSpeedEl = document.getElementById('wind-speed');
const errorEl = document.getElementById('error-message');
const weatherIconEl = document.getElementById('weather-icon');

const cities = [
    { name: "Seoul,KR", lat: 37.5665, lon: 126.9780 },
    { name: "Busan,KR", lat: 35.1796, lon: 129.0756 },
    { name: "Daegu,KR", lat: 35.8714, lon: 128.6014 },
    { name: "Incheon,KR", lat: 37.4563, lon: 126.7052 },
    { name: "Gwangju,KR", lat: 35.1595, lon: 126.8526 },
    { name: "Daejeon,KR", lat: 36.3504, lon: 127.3845 },
    { name: "Ulsan,KR", lat: 35.5384, lon: 129.3114 },
    { name: "Gangneung,KR", lat: 37.7519, lon: 128.8761 },
    { name: "Jeonju,KR", lat: 35.8210, lon: 127.1470 } // ì „ì£¼ ì¶”ê°€
];

// ì§€ë„ ì´ˆê¸°í™”
const map = L.map('map').setView([36.5, 127.5], 7);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 18
}).addTo(map);

// ë§ˆì»¤ ìƒì„± ë° í´ë¦­ ì´ë²¤íŠ¸
cities.forEach(c => {
    const marker = L.marker([c.lat, c.lon]).addTo(map)
        .bindPopup(c.name);

    marker.on('click', () => fetchWeather(c.name, c.lat, c.lon));
});

// ë‚ ì”¨ ê°€ì ¸ì˜¤ê¸°
async function fetchWeather(city, lat, lon) {
    errorEl.textContent = '';
    const url = `${BASE_URL}?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=kr`;

    try {
        const response = await fetch(url);
        const data = await response.json();

        if (response.ok && data.weather) {
            cityNameEl.textContent = city.split(',')[0];
            weatherDescEl.textContent =
                data.weather[0].description.charAt(0).toUpperCase() +
                data.weather[0].description.slice(1);
            tempEl.textContent = data.main.temp.toFixed(1);
            humidityEl.textContent = data.main.humidity;
            windSpeedEl.textContent = data.wind.speed.toFixed(1);

            const iconCode = data.weather[0].icon;
            weatherIconEl.src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

            // ë°°ê²½ ë³€ê²½
            const mainWeather = data.weather[0].main.toLowerCase();
            switch(mainWeather){
                case 'clear': document.body.style.background = 'linear-gradient(135deg, #fceabb, #f8b500)'; break;
                case 'clouds': document.body.style.background = 'linear-gradient(135deg, #d7d2cc, #304352)'; break;
                case 'rain': case 'drizzle': document.body.style.background = 'linear-gradient(135deg, #667db6, #0082c8)'; break;
                case 'thunderstorm': document.body.style.background = 'linear-gradient(135deg, #141e30, #243b55)'; break;
                case 'snow': document.body.style.background = 'linear-gradient(135deg, #e6dada, #274046)'; break;
                case 'mist': case 'fog': document.body.style.background = 'linear-gradient(135deg, #757f9a, #d7dde8)'; break;
                default: document.body.style.background = 'linear-gradient(135deg, #89CFF0, #5D8BF4)';
            }
        } else {
            errorEl.textContent = `âš ï¸ ì˜¤ë¥˜: ${data.message || 'ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}`;
        }

    } catch (error) {
        errorEl.textContent = 'âŒ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        console.error(error);
    }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ë„ì‹œ ì„œìš¸ ë‚ ì”¨
window.onload = () => fetchWeather("Seoul,KR", 37.5665, 126.9780);
</script>

</body>
</html>
